{% extends "base.html" %} 
{% block title %} Aisling's Bus Tours - Hotels {% endblock %}

{% block content %}

    <body>
        <h1>Book a Bus Tour</h1>
        <div>
            <p>Are you a new passenger?</p>
            <div class="form-check">
                <input type="radio" name="answer" value="yes" onclick="showElement1()">Yes
                <input type="radio" name="answer" value="no" onclick="showElement2()">No

                <div id="myDiv1" style="display: none;">
                    <form id="createPassengerForm">
                        {% csrf_token %}
                        <br>
                        <label for="first_name">First Name:</label>
                        <input type="text" id="first_name" name="first_name"><br><br>
                        <label for="last_name">Last Name:</label>
                        <input type="text" id="last_name" name="last_name"><br><br>
                        <label for="email">Email:</label>
                        <input type="email" id="email_address" name="email_address"><br><br>
                        <button type="submit">Create Passenger</button>
                    </form>
                </div>
                <div id="myDiv2" style="display: none;">
                    <h1>Book a Bus Tour</h1>
                    <div>
                        <form id="createBookingForm">
                            {% csrf_token %}
                            <label for="email">Email:</label>
                            <input type="email" id="email_address" name="email_address"><br><br>
                            <label for="tour_id">Tour ID:</label>
                            <input type="text" id="tour_id" name="tour_id"><br><br>
                            <button type="submit">Create Booking</button>
                        </form>
                    </div>
                </div>
                <br> 
                <script>
                    // radio buttons
                    function showElement1() {
                    document.getElementById("myDiv1").style.display = "block";
                    document.getElementById("myDiv2").style.display = "none";
                    }

                    function showElement2() {
                    document.getElementById("myDiv1").style.display = "none";
                    document.getElementById("myDiv2").style.display = "block";
                    }
                    
                    // form submission for passenger to API /create-passenger
                    const form = document.getElementById('createPassengerForm');
                    form.addEventListener('submit', async (event) => {
                        event.preventDefault(); // prevent the default form submit behavior
                        
                        const formData = new FormData(form); // get the form data
                        const data = Object.fromEntries(formData.entries()); // convert the FormData object to a plain object
                        console.log(data);
                        // send the data to your API endpoint
                        const response = await fetch('https://apimaislingsbustours.azure-api.net/bt/create-passenger', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(data)
                        });
                        
                        // handle the response from your API
                        const result = await response.json();
                        console.log(result);
                    });

                    // form submission for create booking to API /create-booking
                    const bookingForm = document.getElementById('createBookingForm');
                    bookingForm.addEventListener('submit', async (event) => {
                        event.preventDefault(); // prevent the default form submit behavior
                        
                        const bookingFormData = new FormData(bookingForm); // get the form data
                        const bookingdata = Object.fromEntries(bookingFormData.entries()); // convert the FormData object to a plain object
                        console.log(bookingdata);
                        // send the data to your API endpoint
                        const response = await fetch('https://apimaislingsbustours.azure-api.net/bt/create-booking', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(bookingdata)
                        });
                        
                        // handle the response from your API
                        const result = await response.json();
                        console.log(result);
                    });
                </script>
            </div>
        </div>
    </body>
{% endblock %}